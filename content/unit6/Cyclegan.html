<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="shortcut icon" href="../../img/favicon.jpg" />
    <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4" />

    <title>Image-to-image translation - Artificial Intelligence</title>

    <link
      rel="stylesheet"
      href="../../assets/stylesheets/main.15aa0b43.min.css"
    />

    <link
      rel="stylesheet"
      href="../../assets/stylesheets/palette.75751829.min.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Inter:300,400,400i,700%7C&display=fallback"
    />
    <style>
      body,
      input {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, Helvetica,
          Arial, sans-serif;
      }

      code,
      kbd,
      pre {
        font-family: "", SFMono-Regular, Consolas, Menlo, monospace;
      }
    </style>

    <link rel="stylesheet" href="../../css/extra.css" />
  </head>

  <body
    dir="ltr"
    data-md-color-scheme=""
    data-md-color-primary="none"
    data-md-color-accent="none"
  >
    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#image-to-image-translation" class="md-skip">
        Skip to content
      </a>
    </div>
    <div data-md-component="announce">
      <aside class="md-announce">
        <div class="md-announce__inner md-grid md-typeset">
          <div id="versionIndicator"><b>Version:</b>27.10.21.a</div>
          <img
            id="customlogo"
            src="../../img/logo.svg"
            alt="University of Leeds logo."
          />
        </div>
      </aside>
    </div>

    <header class="md-header" data-md-component="header">
      <nav class="md-header-nav md-grid" aria-label="Header">
        <a
          href="../../index.html"
          title="Artificial Intelligence"
          class="md-header-nav__button md-logo"
          aria-label="Artificial Intelligence"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"
            />
          </svg>
        </a>
        <label class="md-header-nav__button md-icon" for="__drawer">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z" />
          </svg>
        </label>
        <div class="md-header-nav__title" data-md-component="header-title">
          <div class="md-header-nav__ellipsis">
            <div class="md-header-nav__topic">
              <span class="md-ellipsis"> Artificial Intelligence </span>
            </div>
            <div class="md-header-nav__topic">
              <span class="md-ellipsis"> Image-to-image translation </span>
            </div>
          </div>
        </div>

        <label class="md-header-nav__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
            />
          </svg>
        </label>

        <div class="md-search" data-md-component="search" role="dialog">
          <label class="md-search__overlay" for="__search"></label>
          <div class="md-search__inner" role="search">
            <form class="md-search__form" name="search">
              <input
                type="text"
                class="md-search__input"
                name="query"
                aria-label="Search"
                placeholder="Search"
                autocapitalize="off"
                autocorrect="off"
                autocomplete="off"
                spellcheck="false"
                data-md-component="search-query"
                data-md-state="active"
                required
              />
              <label class="md-search__icon md-icon" for="__search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
                  />
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"
                  />
                </svg>
              </label>
              <button
                type="reset"
                class="md-search__icon md-icon"
                aria-label="Clear"
                data-md-component="search-reset"
                tabindex="-1"
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"
                  />
                </svg>
              </button>
            </form>
            <div class="md-search__output">
              <div class="md-search__scrollwrap" data-md-scrollfix>
                <div class="md-search-result" data-md-component="search-result">
                  <div class="md-search-result__meta">Initializing search</div>
                  <ol class="md-search-result__list"></ol>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="navigation"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--primary"
                  aria-label="Navigation"
                  data-md-level="0"
                >
                  <label class="md-nav__title" for="__drawer">
                    <a
                      href="../../index.html"
                      title="Artificial Intelligence"
                      class="md-nav__button md-logo"
                      aria-label="Artificial Intelligence"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                      >
                        <path
                          d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"
                        />
                      </svg>
                    </a>
                    Artificial Intelligence
                  </label>

                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="../../index.html" class="md-nav__link">
                        Introduction
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit1/Optimisation.html" class="md-nav__link">
                        Optimisation
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="../unit2/LinearClassifier.html"
                        class="md-nav__link"
                      >
                        Linear classifier
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit2/Performance.html" class="md-nav__link">
                        Measuring classifier performance
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="../unit2/MultiLayerNetworks.html"
                        class="md-nav__link"
                      >
                        Multilayer networks
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit3/Convolution.html" class="md-nav__link">
                        Convolution
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit3/CNN.html" class="md-nav__link">
                        Convolutional neural networks
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit3/Segmentation.html" class="md-nav__link">
                        Image segmentation
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit4/Introduction.html" class="md-nav__link">
                        Sequential data
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit4/RNN.html" class="md-nav__link">
                        Recurrent neural networks
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="../unit4/TextClassification.html"
                        class="md-nav__link"
                      >
                        Text classification
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit4/Transformers.html" class="md-nav__link">
                        Transformers
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="../unit5/RelationalData.html"
                        class="md-nav__link"
                      >
                        Relational data
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../unit5/GNN.html" class="md-nav__link">
                        Graph neural networks
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="GAN.html" class="md-nav__link">
                        Generative adversarial networks
                      </a>
                    </li>

                    <li class="md-nav__item md-nav__item--active">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="toc"
                        type="checkbox"
                        id="__toc"
                      />

                      <label
                        class="md-nav__link md-nav__link--active"
                        for="__toc"
                      >
                        Image-to-image translation
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <a
                        href="Cyclegan.html"
                        class="md-nav__link md-nav__link--active"
                      >
                        Image-to-image translation
                      </a>

                      <nav
                        class="md-nav md-nav--secondary"
                        aria-label="Table of contents"
                      >
                        <label class="md-nav__title" for="__toc">
                          <span class="md-nav__icon md-icon"></span>
                          Table of contents
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="#explanation-of-the-overall-method"
                              class="md-nav__link"
                            >
                              Explanation of the overall method
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="#reference" class="md-nav__link">
                              Reference
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--secondary"
                  aria-label="Table of contents"
                >
                  <label class="md-nav__title" for="__toc">
                    <span class="md-nav__icon md-icon"></span>
                    Table of contents
                  </label>
                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a
                        href="#explanation-of-the-overall-method"
                        class="md-nav__link"
                      >
                        Explanation of the overall method
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#reference" class="md-nav__link"> Reference </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-content">
            <article class="md-content__inner md-typeset">
              <h1 id="image-to-image-translation">
                Image-to-image translation
              </h1>
              <p>
                We have seen how a GAN can be used to generate images from a
                latent distribution. Here we explore the use of the GAN
                framework for image-to-image translation.
              </p>
              <p>
                We will be looking in detail at CycleGAN [1], a convolutional
                network for image-to-image translation that has been
                demonstrated for a variety of tasks, including style transfer,
                photo enhancement, object transfiguration and semantic
                segmentation. This method uses an adversarial loss to train the
                network.
              </p>
              <h2 id="explanation-of-the-overall-method">
                Explanation of the overall method
              </h2>
              <p>
                To ground this explanation, we will consider the style transfer
                task of translating from a photo to a stylised painting (e.g. in
                the style of Monet).
              </p>
              <p>
                We start with the domains of photos and paintings
                <span class="arithmatex">\(X\)</span> and
                <span class="arithmatex">\(Y\)</span>, represented by a set of
                photos
                <span class="arithmatex"
                  >\(\{\mymat{x}\}_{i=1}^N\subset X\)</span
                >
                and a set of typical stylised paintings
                <span class="arithmatex"
                  >\(\{\mymat{y}\}_{j=1}^M \subset Y\)</span
                >
                (we use the set notation here for consistency with [1]). The
                data probability distributions are denoted by
                <span class="arithmatex"
                  >\(\mymat{x} \sim p_{data}(\mymat{x})\)</span
                >
                and
                <span class="arithmatex"
                  >\(\mymat{y} \sim p_{data}(\mymat{y})\)</span
                >.
              </p>
              <p>
                The network architecture is based on two convolutional networks:
                <span class="arithmatex">\(G:X \rightarrow Y\)</span> mapping
                from photos to paintings and
                <span class="arithmatex">\(F:Y \rightarrow X\)</span> mapping
                the other way.
              </p>
              <p>
                The figure below shows results from CycleGAN mapping from
                paintings to photos (using
                <span class="arithmatex">\(F\)</span>).
              </p>
              <figure role="group">
                <div class="arithmatex"></div>
                <img
                  src="images/painting2photo.jpg"
                  alt="painting to photo mapping"
                />
                <figcaption>
                  <p><strong>Figure 1</strong> Painting to photo mapping.</p>
                  <p>From <em>Zhu et al.</em> [1]</p>
                </figcaption>
              </figure>

              <p>
                The combined network (<span class="arithmatex">\(G\)</span> and
                <span class="arithmatex">\(F\)</span>) is trained with the given
                sets of photos and paintings. In general, the photos will be
                independent of the paintings and need not depict the same
                scenes. If we had corresponding pairs of photos and paintings,
                we could use a supervised training regime. In the absence of
                corresponding pairs, CycleGAN uses an adversarial approach.
              </p>
              <p>
                Consider first the mapping
                <span class="arithmatex">\(G:X \rightarrow Y\)</span>. There is
                a discriminator <span class="arithmatex">\(D_Y\)</span> that
                distinguishes between real paintings from
                <span class="arithmatex">\(Y\)</span> and fake paintings emitted
                by G. The discriminator
                <span class="arithmatex">\(D_Y\)</span> is updated to increase
                the objective:
              </p>
              <div class="arithmatex">
                \[ \mathcal{L}_{GAN}(G,D_Y,X,Y)=\mathbb{E}_{\mymat{y} \sim
                p_{data}(y)} \log(D_Y(\mymat{y})) + \mathbb{E}_{\mymat{x} \sim
                p_{data}(x)} \log(1-D_Y(G(\mymat{x})))\]
              </div>
              <p>
                There is an analagous discriminator
                <span class="arithmatex">\(D_X\)</span> that distinguishes
                between real photos from
                <span class="arithmatex">\(X\)</span> and fake photos emitted by
                <span class="arithmatex">\(F\)</span>. The discriminator
                <span class="arithmatex">\(D_X\)</span> is updated to increase
                the objective
                <span class="arithmatex">\(\mathcal{L}_{GAN}(F,D_X,X,Y)\)</span
                >.
              </p>
              <p>
                If we were to simply focus on training
                <span class="arithmatex">\(G\)</span> adversarially using
                <span class="arithmatex">\(D_Y\)</span>, we might expect that
                <span class="arithmatex">\(G\)</span> would start to produce
                paintings from input photos. However, it is unlikely the
                paintings produced would look anything like the input photos.
                These input photos can be seen as simply fulfilling the role of
                the random input vectors in DCGAN. The same argument holds for
                <span class="arithmatex">\(F\)</span> when trained adversarially
                using the discriminator <span class="arithmatex">\(D_X\)</span>.
              </p>
              <p>
                The solution to making the output from
                <span class="arithmatex">\(G\)</span> resemble the input, and
                similarly for <span class="arithmatex">\(F\)</span>, is to send
                photos sampled from
                <span class="arithmatex">\(p_{data}(x)\)</span> on a round tour,
                generating paintings using
                <span class="arithmatex">\(G\)</span> and then returning to
                photos using F. We then add another term to the overall loss
                used in training the generator that penalises differences
                between the original photos and the corresponding photos after
                cycling through <span class="arithmatex">\(G\)</span> and
                <span class="arithmatex">\(F\)</span>. This 'cycle consistency'
                loss is:
              </p>
              <div class="arithmatex">
                \[ \mathcal{L}_{cyc}(G,F)=\mathbb{E}_{\mymat{x} \sim
                p_{data}(x)}\big[\| F(G(\mymat{x}))-\mymat{x} \|_1\big] +
                \mathbb{E}_{\mymat{y} \sim p_{data}(y)}\big[\|
                G(F(\mymat{y}))-\mymat{y} \|_1\big]\]
              </div>
              <p>
                The discriminators <span class="arithmatex">\(D_X\)</span> and
                <span class="arithmatex">\(D_Y\)</span> and generators
                <span class="arithmatex">\(G\)</span> and
                <span class="arithmatex">\(F\)</span> are updated alternately
                until convergence or a fixed number of epochs. Both generators
                are updated together using the objective:
              </p>
              <div class="arithmatex">
                \[ \mathcal{L}(G,F,D_X, D_Y)=\mathcal{L}_{GAN}(G,D_Y,X,Y) +
                \mathcal{L}_{GAN}(F,D_X,X,Y) + \lambda\mathcal{L}_{cyc}(G,F) \]
              </div>
              <p>
                where <span class="arithmatex">\(\lambda\)</span> controls the
                relative importance of the photos and paintings looking
                realistic, versus the extent to which input and output images
                are in spatial correspondence.
              </p>
              <div class="admonition abstract">
                <p class="admonition-title">Reading</p>
                <p>
                  To gain an in depth understanding of CycleGAN, please look at
                  the
                  <a href="https://junyanz.github.io/CycleGAN/"
                    >dedicated website</a
                  >
                  and read the paper that appeared in the International
                  Conference in Computer Vision in 2017 [1]. The paper and
                  website contain many examples of CycleGAN applied to a range
                  of tasks.
                </p>
              </div>
              <h2 id="reference">Reference</h2>
              <p>
                [1]
                <a href="http://arxiv.org/abs/1703.10593"
                  ><em
                    >Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A.
                    Efros. "Unpaired Image-to-Image Translation using
                    Cycle-Consistent Adversarial Networks", in IEEE
                    International Conference on Computer Vision (ICCV), 2017</em
                  ></a
                >.
              </p>
            </article>
          </div>
        </div>
      </main>

      <footer class="md-footer">
        <div class="md-footer-nav">
          <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
            <a
              href="GAN.html"
              class="md-footer-nav__link md-footer-nav__link--prev"
              rel="prev"
            >
              <div class="md-footer-nav__button md-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"
                  />
                </svg>
              </div>
              <div class="md-footer-nav__title">
                <div class="md-ellipsis">
                  <span class="md-footer-nav__direction"> Previous </span>
                  Generative adversarial networks
                </div>
              </div>
            </a>
          </nav>
        </div>

        <div class="md-footer-meta md-typeset">
          <div class="md-footer-meta__inner md-grid">
            <div class="md-footer-copyright">
              <div class="md-footer-copyright__highlight">
                Copyright © University of Leeds
              </div>

              Made with
              <a
                href="https://squidfunk.github.io/mkdocs-material/"
                target="_blank"
                rel="noopener"
              >
                Material for MkDocs
              </a>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
    <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script>
    <script id="__lang" type="application/json">
      {
        "clipboard.copy": "Copy to clipboard",
        "clipboard.copied": "Copied to clipboard",
        "search.config.lang": "en",
        "search.config.pipeline": "trimmer, stopWordFilter",
        "search.config.separator": "[\\s\\-]+",
        "search.placeholder": "Search",
        "search.result.placeholder": "Type to start searching",
        "search.result.none": "No matching documents",
        "search.result.one": "1 matching document",
        "search.result.other": "# matching documents",
        "search.result.more.one": "1 more on this page",
        "search.result.more.other": "# more on this page",
        "search.result.term.missing": "Missing"
      }
    </script>

    <script>
      app = initialize({
        base: "../..",
        features: ["navigation.sections"],
        search: Object.assign(
          {
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js",
          },
          typeof search !== "undefined" && search
        ),
      });
    </script>

    <script src="../../javascript/tablecontentsoverride.js"></script>

    <script src="../../javascript/config.js"></script>

    <script src="../../javascript/interactive-elements.js"></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>
</html>

<!doctype html>
<html lang="en" class="no-js">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">




    <link rel="shortcut icon" href="../../img/favicon.jpg">
    <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">



    <title>Graph neural networks - Artificial Intelligence</title>



    <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">


    <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">







    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,400i,700%7C&display=fallback">
    <style>
        body,
        input {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif
        }

        code,
        kbd,
        pre {
            font-family: "", SFMono-Regular, Consolas, Menlo, monospace
        }
    </style>




    <link rel="stylesheet" href="../../css/extra.css">





</head>







<body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">



    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">


        <a href="#graph-neural-networks" class="md-skip">
          Skip to content
        </a>

    </div>
    <div data-md-component="announce">

        <aside class="md-announce">
            <div class="md-announce__inner md-grid md-typeset">

                <div id="versionIndicator"> <b>Version:</b>27.10.21.a </div>
                <img id="customlogo" src="../../img/logo.svg" alt="University of Leeds logo.">

            </div>
        </aside>

    </div>





    <header class="md-header" data-md-component="header">
        <nav class="md-header-nav md-grid" aria-label="Header">
            <a href="../../index.html" title="Artificial Intelligence" class="md-header-nav__button md-logo" aria-label="Artificial Intelligence">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
            <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
            <div class="md-header-nav__title" data-md-component="header-title">
                <div class="md-header-nav__ellipsis">
                    <div class="md-header-nav__topic">
                        <span class="md-ellipsis">
            Artificial Intelligence
          </span>
                    </div>
                    <div class="md-header-nav__topic">
                        <span class="md-ellipsis">
            
              Graph neural networks
            
          </span>
                    </div>
                </div>
            </div>

            <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>

            <div class="md-search" data-md-component="search" role="dialog">
                <label class="md-search__overlay" for="__search"></label>
                <div class="md-search__inner" role="search">
                    <form class="md-search__form" name="search">
                        <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
                        <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
                        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
                    </form>
                    <div class="md-search__output">
                        <div class="md-search__scrollwrap" data-md-scrollfix>
                            <div class="md-search-result" data-md-component="search-result">
                                <div class="md-search-result__meta">
                                    Initializing search
                                </div>
                                <ol class="md-search-result__list"></ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </nav>
    </header>

    <div class="md-container" data-md-component="container">




        <main class="md-main" data-md-component="main">
            <div class="md-main__inner md-grid">



                <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                    <div class="md-sidebar__scrollwrap">
                        <div class="md-sidebar__inner">







                            <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
                                <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Artificial Intelligence" class="md-nav__button md-logo" aria-label="Artificial Intelligence">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Artificial Intelligence
  </label>

                                <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                        <a href="../../index.html" class="md-nav__link">
      Introduction
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit1/Optimisation.html" class="md-nav__link">
      Optimisation
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit2/LinearClassifier.html" class="md-nav__link">
      Linear classifier
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit2/Performance.html" class="md-nav__link">
      Measuring classifier performance
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit2/MultiLayerNetworks.html" class="md-nav__link">
      Multilayer networks
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit3/Convolution.html" class="md-nav__link">
      Convolution
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit3/CNN.html" class="md-nav__link">
      Convolutional neural networks
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit3/Segmentation.html" class="md-nav__link">
      Image segmentation
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit4/Introduction.html" class="md-nav__link">
      Sequential data
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit4/RNN.html" class="md-nav__link">
      Recurrent neural networks
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit4/TextClassification.html" class="md-nav__link">
      Text classification
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit4/Transformers.html" class="md-nav__link">
      Transformers
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="RelationalData.html" class="md-nav__link">
      Relational data
    </a>
                                    </li>










                                    <li class="md-nav__item md-nav__item--active">

                                        <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">




                                        <label class="md-nav__link md-nav__link--active" for="__toc">
        Graph neural networks
        <span class="md-nav__icon md-icon"></span>
      </label>

                                        <a href="GNN.html" class="md-nav__link md-nav__link--active">
      Graph neural networks
    </a>


                                        <nav class="md-nav md-nav--secondary" aria-label="Table of contents">





                                            <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
                                            <ul class="md-nav__list" data-md-scrollfix>

                                                <li class="md-nav__item">
                                                    <a href="#graph-structure" class="md-nav__link">
    Graph structure
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#gn-block" class="md-nav__link">
    GN Block
  </a>

                                                    <nav class="md-nav" aria-label="GN Block">
                                                        <ul class="md-nav__list">

                                                            <li class="md-nav__item">
                                                                <a href="#1-update-edge-attribute-values" class="md-nav__link">
    (1) Update edge attribute values
  </a>

                                                            </li>

                                                            <li class="md-nav__item">
                                                                <a href="#2-aggregate-edge-attribute-values-at-receiving-nodes" class="md-nav__link">
    (2) Aggregate edge attribute values at receiving nodes
  </a>

                                                            </li>

                                                            <li class="md-nav__item">
                                                                <a href="#3-update-node-attribute-values" class="md-nav__link">
    (3) Update node attribute values
  </a>

                                                            </li>

                                                            <li class="md-nav__item">
                                                                <a href="#4-aggregate-edge-attribute-values-globally" class="md-nav__link">
    (4) Aggregate edge attribute values globally
  </a>

                                                            </li>

                                                            <li class="md-nav__item">
                                                                <a href="#5-aggregate-node-attribute-values-globally" class="md-nav__link">
    (5) Aggregate node attribute values globally
  </a>

                                                            </li>

                                                            <li class="md-nav__item">
                                                                <a href="#6-update-global-attribute-value" class="md-nav__link">
    (6) Update global attribute value
  </a>

                                                            </li>

                                                        </ul>
                                                    </nav>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#composing-gn-blocks" class="md-nav__link">
    Composing GN blocks
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#physics-based-example" class="md-nav__link">
    Physics-based example
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#references" class="md-nav__link">
    References
  </a>

                                                </li>

                                            </ul>

                                        </nav>

                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit6/GAN.html" class="md-nav__link">
      Generative adversarial networks
    </a>
                                    </li>








                                    <li class="md-nav__item">
                                        <a href="../unit6/Cyclegan.html" class="md-nav__link">
      Image-to-image translation
    </a>
                                    </li>


                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>



                <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                    <div class="md-sidebar__scrollwrap">
                        <div class="md-sidebar__inner">

                            <nav class="md-nav md-nav--secondary" aria-label="Table of contents">





                                <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
                                <ul class="md-nav__list" data-md-scrollfix>

                                    <li class="md-nav__item">
                                        <a href="#graph-structure" class="md-nav__link">
    Graph structure
  </a>

                                    </li>

                                    <li class="md-nav__item">
                                        <a href="#gn-block" class="md-nav__link">
    GN Block
  </a>

                                        <nav class="md-nav" aria-label="GN Block">
                                            <ul class="md-nav__list">

                                                <li class="md-nav__item">
                                                    <a href="#1-update-edge-attribute-values" class="md-nav__link">
    (1) Update edge attribute values
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#2-aggregate-edge-attribute-values-at-receiving-nodes" class="md-nav__link">
    (2) Aggregate edge attribute values at receiving nodes
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#3-update-node-attribute-values" class="md-nav__link">
    (3) Update node attribute values
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#4-aggregate-edge-attribute-values-globally" class="md-nav__link">
    (4) Aggregate edge attribute values globally
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#5-aggregate-node-attribute-values-globally" class="md-nav__link">
    (5) Aggregate node attribute values globally
  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                    <a href="#6-update-global-attribute-value" class="md-nav__link">
    (6) Update global attribute value
  </a>

                                                </li>

                                            </ul>
                                        </nav>

                                    </li>

                                    <li class="md-nav__item">
                                        <a href="#composing-gn-blocks" class="md-nav__link">
    Composing GN blocks
  </a>

                                    </li>

                                    <li class="md-nav__item">
                                        <a href="#physics-based-example" class="md-nav__link">
    Physics-based example
  </a>

                                    </li>

                                    <li class="md-nav__item">
                                        <a href="#references" class="md-nav__link">
    References
  </a>

                                    </li>

                                </ul>

                            </nav>
                        </div>
                    </div>
                </div>


                <div class="md-content">
                    <article class="md-content__inner md-typeset">



                        <h1 id="graph-neural-networks">Graph neural networks</h1>
                        <p>There are several kinds of <em>Graph neural network (GNN)</em> in the literature. We adopt the unifying framework described by Battaglia et al. [1] since this subsumes many of the different approaches. In accordance with this,
                            we will sometimes refer to a GNN as a <em>Graph Network (GN)</em> although this term isn't in common use.</p>
                        <h2 id="graph-structure">Graph structure</h2>
                        <p>A <em>GN graph</em> is made up of a set of <span class="arithmatex">\(N^v\)</span> nodes (vertices) <span class="arithmatex">\(V\)</span>, a set of <span class="arithmatex">\(N^e\)</span> directed edges <span class="arithmatex">\(E\)</span>                            connecting pairs of nodes (including self-connections), and a global attribute <span class="arithmatex">\(\myvec{u}\)</span>. Each node has an associated attribute vector <span class="arithmatex">\(\myvec{v}_i\)</span>, so
                            we write the set of nodes as <span class="arithmatex">\(V=\{(\myvec{v}_i,i)\}_{i=1:N^v}\)</span>. Each directed edge has an associated attribute <span class="arithmatex">\(\myvec{e}_k\)</span>, so we write the set of edges
                            as <span class="arithmatex">\(E=\{(\myvec{e}_k,r_k,s_k)\}_{k=1:N^e}\)</span>, where <span class="arithmatex">\(r_k\)</span> is the index of the <em>receiver</em> node (i.e. the endpoint of the directed edge) and <span class="arithmatex">\(s_k\)</span>                            is the index of the <em>sender</em> node (i.e. the start-point of the directed edge). This terminology comes from the idea of sending messages along edges. The attributes <span class="arithmatex">\(\myvec{u}, \myvec{v}_i, \myvec{e}_k\)</span>                            could be scalars, vectors, tensors (e.g. a colour image), or something different altogether. We will simply denote them as vectors.</p>
                        <hr />
                        <p><strong>Note</strong></p>
                        <p>The set notation in the previous paragraph is used for consistency with Battaglia et al. [1]. However, we differ from Battaglia et al. [1] by including the node index in the specification of each node, just as they are included
                            in for the specification of edges. It is interesting to observe that this notation scales to a <em>hypergraph</em> by simply listing the indices of the nodes involved in each <em>hyperedge</em>, including the special case of
                            a hyperedge involving a single node, which is synonymous with a node.</p>
                        <hr />
                        <p>In standard terms, a GN Graph is a directed, attributed <em>multigraph</em> with a global attribute. A multigraph is a graph where there may be more than one edge between any pair of nodes. In what follows, we will refer to it
                            as a 'graph' for brevity.</p>
                        <p>In the following diagram of a graph with four nodes and six edges, we show only the attribute values at each node and on each edge.</p>
                        <figure role="group">
                            <img src="images/graph3.svg" alt="an example graph" />
                            <figcaption>
                                <p><strong>Figure 1.</strong> An example graph.</p>
                            </figcaption>
                        </figure>

                        <p>The definition of this graph is as follows:</p>
                        <div class="arithmatex">\[ V = \{(\myvec{v}_1,1), (\myvec{v}_2,2),(\myvec{v}_3,3),(\myvec{v}_4,4)\} \]</div>
                        <div class="arithmatex">\[ E = \{(\myvec{e}_1,1,3),(\myvec{e}_2,2,1),(\myvec{e}_3,2,1),(\myvec{e}_4,2,3),(\myvec{e}_5,1,1),(\myvec{e}_6,4,2)\}\]</div>
                        <h2 id="gn-block">GN Block</h2>
                        <p>The active part of a GNN is a function that updates the edge, node and global attribute values of a graph. The function is applied iteratively to produce a final output graph. We are interested in functions that are implemented
                            using neural networks and refer to the function as a <em>GN block</em>. Thus, a GN block takes a graph as input and produces a graph with updated attribute values as output. The output graph has the same structure of nodes
                            and edges as the input graph. The transformation of attribute values involves six steps, all of which depend on the structure of the graph. Most of the computations are local to a node or edge in the graph. For example, node
                            attribute values are updated based on the values of attributes at that node, and at the edges for which the node is a receiver:</p>
                        <figure role="group">
                            <img src="images/graph4.svg" alt="The GN block transforms the attribute values of a graph" />
                            <figcaption>
                                <p><strong>Figure 1.</strong> The GN block transforms the attribute values of a graph.</p>
                            </figcaption>
                        </figure>

                        <p>The six steps are as follows:</p>
                        <h3 id="1-update-edge-attribute-values">(1) Update edge attribute values</h3>
                        <p>The attribute value on each edge is updated based on the attribute values at the nodes on either end, and on the global attribute. As a result, the attribute value on edge <span class="arithmatex">\(k\)</span> is updated as follows:</p>
                        <div class="arithmatex">\[ \myvec{e}'_k = \phi^e(\myvec{e}_k,\myvec{v}_{r_k},\myvec{v}_{s_k},\myvec{u})\]</div>
                        <p>The following diagram shows the attributes involved in updating the attribute value on edge 6:</p>
                        <figure role="group">
                            <img src="../images/graph5.svg" alt="Step 1: updating the edge attribute value on edge 6" />
                            <figcaption>
                                <p><strong>Figure 2.</strong> Step 1: updating the edge attribute value on edge 6.</p>
                            </figcaption>
                        </figure>

                        <h3 id="2-aggregate-edge-attribute-values-at-receiving-nodes">(2) Aggregate edge attribute values at receiving nodes</h3>
                        <p>At each node, <span class="arithmatex">\(i\)</span>, we aggregate the (updated) attribute values on edges <span class="arithmatex">\(E'_i\)</span> for which this node is a receiver (i.e. all incoming edges). Because we don't want
                            the result to depend on an ordering of incoming edges, the aggregation function <span class="arithmatex">\(\rho^{e-&gt;v}\)</span> must be invariant to permutations of the edges. Typically we use the sum, mean or maximum value
                            applying the function component-wise to the inputs:</p>
                        <div class="arithmatex">\[E'_i=\{(\myvec{e}'_k,r_k,s_k)\}_{r_k=i,k=1:N^e}\]</div>
                        <div class="arithmatex">\[\myvec{\bar{e}}'_i=\rho^{e-&gt;v}(E'_i)\]</div>
                        <p>In our running example, using the mean as the aggregation function, the aggregate of edge attribute values at the node 2 is given by <span class="arithmatex">\(\myvec{\bar{e}}'_2=(\myvec{e}'_2+\myvec{e}'_3+\myvec{e}'_4)/3\)</span>:</p>
                        <figure role="group">
                            <img src="images/graph6.svg" alt="Step 2: updating the aggregate of edge attribute values at node 2" />
                            <figcaption>
                                <p><strong>Figure 3.</strong> Step 2: updating the aggregate of edge attribute values at node 2.</p>
                            </figcaption>
                        </figure>

                        <h3 id="3-update-node-attribute-values">(3) Update node attribute values</h3>
                        <p>The attribute value at each node is updated based on its current value, the aggregate edge attribute value for the node, computed in step 2, and the global attribute value:</p>
                        <div class="arithmatex">\[ \myvec{v}'_i = \phi^v(\myvec{\bar{e}}'_i,\myvec{v}_i,\myvec{u})\]</div>
                        <p>Here we show the update to the attribute value at node 2:</p>
                        <figure role="group">
                            <img src="../images/graph7.svg" alt="Step 3: updating the node attribute value at node 2" />
                            <figcaption>
                                <p><strong>Figure 4.</strong> Step 3: updating the node attribute value at node 2.</p>
                            </figcaption>
                        </figure>

                        <h3 id="4-aggregate-edge-attribute-values-globally">(4) Aggregate edge attribute values globally</h3>
                        <p>We aggregate the updated edge attribute values across all edges <span class="arithmatex">\(E'\)</span>. Again, the aggregation function needs to be invariant to permutations of the edges, so we normally choose one of sum, mean
                            or max:</p>
                        <div class="arithmatex">\[ E'=\{(\myvec{e}'_k,r_k,s_k)\}_{k=1:N^e} \]</div>
                        <div class="arithmatex">\[ \myvec{\bar{e}}'=\rho^{e-&gt;u}(E') \]</div>
                        <p>Using max as the aggregation function, the aggregate of edge attribute values is:</p>
                        <div class="arithmatex">\[\myvec{\bar{e}}'=\max(\myvec{e}'_1,\myvec{e}'_2,\myvec{e}'_3,\myvec{e}'_4,\myvec{e}'_5,\myvec{e}'_6)\]</div>
                        <figure role="group">
                            <img src="images/graph8.svg" alt="Step 4: computing the global aggregate of updated edge attribute values" />
                            <figcaption>
                                <p><strong>Figure 5.</strong> Step 4: computing the global aggregate of updated edge attribute values.</p>
                            </figcaption>
                        </figure>

                        <h3 id="5-aggregate-node-attribute-values-globally">(5) Aggregate node attribute values globally</h3>
                        <p>We aggregate the updated node attribute values across all nodes <span class="arithmatex">\(V'\)</span>:</p>
                        <div class="arithmatex">\[ V'=\{\myvec{v}'_i\}_{i=1:N^v} \]</div>
                        <div class="arithmatex">\[ \myvec{\bar{v}}'=\rho^{v-&gt;u}(V')\]</div>
                        <p>Using sum as the aggregation function, the aggregate of updated node attributes values is:</p>
                        <div class="arithmatex">\[\myvec{\bar{v}}'=\myvec{v}'_1+\myvec{v}'_2+\myvec{v}'_3+\myvec{v}'_4\]</div>
                        <figure role="group">
                            <img src="images/graph9.svg" alt="Step 5: computing the global aggregate of updated node attribute values" />
                            <figcaption>
                                <p><strong>Figure 6.</strong> Step 5: computing the global aggregate of updated node attribute values.</p>
                            </figcaption>
                        </figure>

                        <h3 id="6-update-global-attribute-value">(6) Update global attribute value</h3>
                        <p>Finally, we update the global attribute value as a function of the global aggregate values across edges (step 4) and nodes (step 5), and the current global attribute value:</p>
                        <div class="arithmatex">\[ \myvec{u}'=\phi^u(\myvec{\bar{e}}',\myvec{\bar{v}}',\myvec{u})\]</div>
                        <figure role="group">
                            <img src="images/graph10.svg" alt="Step 6: updating the global attribute value" />
                            <figcaption>
                                <p><strong>Figure 7.</strong> Step 6: updating the global attribute value.</p>
                            </figcaption>
                        </figure>

                        <p>Steps 1-3 can be carried out in parallel at each node or edge as appropriate.</p>
                        <h2 id="composing-gn-blocks">Composing GN blocks</h2>
                        <p>The three functions at the heart of the GN block, <span class="arithmatex">\(\phi^e,\phi^v,\phi^u\)</span> can have many forms. Typically, it is a single linear layer but could also be a multi-layer (deep) network, or CNN when
                            the attributes are images.</p>
                        <p>The GN block either operates locally (steps 1-3) or globally (steps 4-5). Just as for a CNN, we increase the scale of the local updates by composing (layering) GN blocks, as illustrated below, where <span class="arithmatex">\(M\)</span>                            GN blocks are composed together, taking the graph <span class="arithmatex">\(G_0\)</span> as input and producing the graph <span class="arithmatex">\(G_M\)</span> as output:</p>
                        <figure role="group">
                            <img src="images/graph11.svg" alt="Composing GN blocks together" />
                            <figcaption>
                                <p><strong>Figure 8.</strong> Composing GN blocks together.</p>
                            </figcaption>
                        </figure>

                        <h2 id="physics-based-example">Physics-based example</h2>
                        <p>Battaglia et al. [1] give a physics-based example to motivate the six steps of the GNN.</p>
                        <p>Imagine we have a set of rubber balls connected by springs and subject to gravity. We can represent this as a graph as below:</p>
                        <figure role="group">
                            <img src="images/graph12.svg" alt="Balls connected by springs, represented as a graph" />
                            <figcaption>
                                <p><strong>Figure 9.</strong> Balls connected by springs, represented as a graph.</p>
                            </figcaption>
                        </figure>

                        <p>A simulation of the balls in motion could be achieved via the six steps of a GN block as follows:</p>
                        <table>
                            <thead>
                                <tr>
                                    <th align="left">GN block step</th>
                                    <th align="left">Physical process</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td align="left">Step 1: Update edge attribute values</td>
                                    <td align="left"><em>Forces between balls</em></td>
                                </tr>
                                <tr>
                                    <td align="left">Step 2: Aggregate edge attribute values at receiving nodes</td>
                                    <td align="left"><em>Sum of forces (net force) on each ball</em></td>
                                </tr>
                                <tr>
                                    <td align="left">Step 3: Update node attribute values</td>
                                    <td align="left"><em>Position, velocity and kinetic energy of each ball</em></td>
                                </tr>
                                <tr>
                                    <td align="left">Step 4: Aggregate edge attribute values globally</td>
                                    <td align="left"><em>Sum of per-node forces (should be zero) and potential energy store in springs</em></td>
                                </tr>
                                <tr>
                                    <td align="left">Step 5: Aggregate node attribute values globally</td>
                                    <td align="left"><em>Total kinetic energy of system</em></td>
                                </tr>
                                <tr>
                                    <td align="left">Step 6: Update global attribute value</td>
                                    <td align="left"><em>Net forces and total energy of system</em></td>
                                </tr>
                            </tbody>
                        </table>
                        <h2 id="references">References</h2>
                        <p>[1] <a href="https://arxiv.org/pdf/1806.01261.pdf"><em>Battaglia, P.W., et al., Relational inductive biases, deep learning, and graph networks</em></a></p>







                    </article>
                </div>
            </div>
        </main>


        <footer class="md-footer">

            <div class="md-footer-nav">
                <nav class="md-footer-nav__inner md-grid" aria-label="Footer">

                    <a href="RelationalData.html" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
                        <div class="md-footer-nav__button md-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
                        </div>
                        <div class="md-footer-nav__title">
                            <div class="md-ellipsis">
                                <span class="md-footer-nav__direction">
                  Previous
                </span> Relational data
                            </div>
                        </div>
                    </a>


                    <a href="../unit6/GAN.html" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
                        <div class="md-footer-nav__title">
                            <div class="md-ellipsis">
                                <span class="md-footer-nav__direction">
                  Next
                </span> Generative adversarial networks
                            </div>
                        </div>
                        <div class="md-footer-nav__button md-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
                        </div>
                    </a>

                </nav>
            </div>

            <div class="md-footer-meta md-typeset">
                <div class="md-footer-meta__inner md-grid">
                    <div class="md-footer-copyright">

                        <div class="md-footer-copyright__highlight">
                            Copyright © University of Leeds
                        </div>

                        Made with
                        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
                    </div>

                </div>
            </div>
        </footer>

    </div>

    <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
    <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script>
    <script id="__lang" type="application/json">
        {
            "clipboard.copy": "Copy to clipboard",
            "clipboard.copied": "Copied to clipboard",
            "search.config.lang": "en",
            "search.config.pipeline": "trimmer, stopWordFilter",
            "search.config.separator": "[\\s\\-]+",
            "search.placeholder": "Search",
            "search.result.placeholder": "Type to start searching",
            "search.result.none": "No matching documents",
            "search.result.one": "1 matching document",
            "search.result.other": "# matching documents",
            "search.result.more.one": "1 more on this page",
            "search.result.more.other": "# more on this page",
            "search.result.term.missing": "Missing"
        }
    </script>

    <script>
        app = initialize({
            base: "../..",
            features: ['navigation.sections'],
            search: Object.assign({
                worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
            }, typeof search !== "undefined" && search)
        })
    </script>

    <script src="../../javascript/tablecontentsoverride.js"></script>

    <script src="../../javascript/config.js"></script>

    <script src="../../javascript/interactive-elements.js"></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


</body>

</html>